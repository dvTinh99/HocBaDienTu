package Dao;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import Model.HocSinh;
import Model.MonHoc;

public class GiaoVienDao {
	public static Connection conn;

	public static List<MonHoc> getMonHoc(){
		List<MonHoc> list = new ArrayList<MonHoc>();
		ConnectToDB connect = new ConnectToDB();
		conn = connect.getConnection();
		try {
			String sql = "select Ma_Mon, Ten_Mon, Ma_cap from Mon_Hoc" ;
			Statement st = conn.createStatement();
			ResultSet rs = st.executeQuery(sql);
			
			while(rs.next()) {
//				System.out.println(rs.getInt(3));
				MonHoc mh = new MonHoc(rs.getInt(1), rs.getString(2),rs.getInt(3));
				list.add(mh);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return list;
	}
	public static List<HocSinh> getHocSinh(){
		List<HocSinh> list = new ArrayList<HocSinh>();
		ConnectToDB connect = new ConnectToDB();
		conn = connect.getConnection();
		try {
			String sql = "SELECT [Ma_hs]"
					+ "      ,[Ho]"
					+ "      ,[Ten]"
					+ "      ,[Gioi_Tinh]"
					+ "      ,[Ngay_Sinh]"
					+ "      ,[Dia_Chi]"
					+ "      ,[Sdt]"
					+ "      ,[CMND]"
					+ "  FROM [HocBaDienTu].[dbo].[Hoc_sinh]" ;
			Statement st = conn.createStatement();
			ResultSet rs = st.executeQuery(sql);
			
			while(rs.next()) {
//				System.out.println(rs.getInt(3));
				HocSinh hs = new HocSinh(rs.getInt(1), rs.getString(2), rs.getString(3), rs.getString(4),
						rs.getString(5), rs.getString(6), rs.getString(7), rs.getString(8));
				list.add(hs);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return list;
	}
}
